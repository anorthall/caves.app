{% extends "base_public.html" %}
{% block title %}{{ user.first_name }}'s trips{% endblock %}
{% block description %}{{ user.full_name }}'s trips on caves.app.{% endblock %}
{% block main %}

<div class="container">
  <div class="row border-bottom border-3 border-primary mt-4">
    <h1 class="display-5">{{ user.first_name }} {{ user.last_name }}'s trips</h1>
  </div>

  <div class="row mt-3">
    <div class="col">
      {% if user.bio %}
        {{ user.bio|linebreaks }}
      {% elif not user.bio and not trips %}
        This is the public profile of a caves.app user who has not added any trips or a bio yet.
      {% endif %}
    </div>
  </div>

  {% if trips %}
    <div class="row mt-3">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th scope="col">Date</th>
              <th scope="col">Cave</th>
              <th scope="col" class="d-none d-lg-table-cell">Region</th>
              <th scope="col" class="d-none d-lg-table-cell">Country</th>
              <th scope="col" class="d-none d-md-table-cell">Duration</th>
            </tr>
          </thead>

          <tbody>
            {% for trip in trips %}
              <tr data-href="{% url 'public:trip' trip.user.username trip.pk %}">
                <td>{{ trip.start|date }}</td>
                <td>
                  {% if trip.cave_url %}
                    <a href="{{ trip.cave_url }}" target="_blank">{{ trip.cave_name }}</a>
                  {% else %}
                    {{ trip.cave_name }}
                  {% endif %}
                </td>
                <td class="d-none d-lg-table-cell">{{ trip.cave_region }}</td>
                <td class="d-none d-lg-table-cell">{{ trip.cave_country }}</td>
                <td class="d-none d-md-table-cell">{{ trip.duration_str }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  {% endif %}
</div>

{% endblock main %}

{% block footer_scripts %}
<!-- Clickable table rows -->
<script src="https://code.jquery.com/jquery-3.6.4.slim.min.js" integrity="sha256-a2yjHM4jnF9f54xUQakjZGaqYs/V1CYvWpoqZzC2/Bw=" crossorigin="anonymous"></script>
<script>
  jQuery(document).ready(function($) {
    $('*[data-href]').on('click', function() {
        window.location = $(this).data("href");
    });
  });
</script>
{% endblock footer_scripts %}
