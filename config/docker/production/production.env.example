### Production environment for caves.app
### https://github.com/anorthall/caves.app


### Django configuration
### https://docs.djangoproject.com/en/dev/topics/settings/

DJANGO_SETTINGS_MODULE=config.django.settings.production
DJANGO_LOG_LEVEL=WARNING

# Debug *MUST* be off (0) in production
DEBUG=0

# Security
SECRET_KEY=insecure-secret-key
DJANGO_ALLOWED_HOSTS=your-app.com
CSRF_TRUSTED_ORIGINS=https://your-app.com/ https://www.your-app.com/
SECURE_HSTS_SECONDS=0
SECURE_HSTS_INCLUDE_SUBDOMAINS=0
SECURE_HSTS_PRELOAD=0
SECURE_SSL_REDIRECT=0
SESSION_COOKIE_SECURE=0
CSRF_COOKIE_SECURE=0
SECURE_PROXY_SSL_HEADER=0

# Database
SQL_ENGINE=django.db.backends.postgresql
SQL_DATABASE=postgres
SQL_USER=postgres
SQL_PASSWORD=postgres
SQL_HOST=db
SQL_PORT=5432
CONN_MAX_AGE=900

# Email
EMAIL_BACKEND=mailer.backend.DbBackend
MAILER_EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
MAILER_EMPTY_QUEUE_SLEEP=10
DEFAULT_FROM_EMAIL=your app <mail@your-app.com>
EMAIL_HOST=
EMAIL_PORT=
EMAIL_USE_SSL=0
EMAIL_USE_TLS=0
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=

# Container start options
COLLECT_STATIC=no  # collect static files on launch
RUN_MIGRATIONS=yes  # run migrations on launch
RUN_MAILER=yes  # run python manage.py runmailer on launch

# Site title (for navbar)
SITE_TITLE=your-app

# URLs
SITE_ROOT=https://your-app.com
ADMIN_URL=admin/
STAFF_URL=staff/
MEDIA_ROOT=https://cdn.your-app.com/m/
STATIC_ROOT=https://cdn.your-app.com/s/

# Sentry SDK key
SENTRY_KEY=

# Google Analytics key
GOOGLE_ANALYTICS_ID=

# AWS S3
AWS_S3_CUSTOM_DOMAIN=cdn.your-app.com
AWS_S3_ACCESS_KEY_ID=
AWS_S3_SECRET_ACCESS_KEY=
AWS_STORAGE_BUCKET_NAME=
AWS_S3_REGION_NAME=
AWS_S3_SIGNATURE_VERSION=s3v4
AWS_DEFAULT_ACL=private
AWS_PRESIGNED_EXPIRY=120


### Imgproxy configuration
### https://docs.imgproxy.net/configuration

# Network
IMGPROXY_URL=https://your-app.com/imgproxy  # used by Django only
IMGPROXY_BIND=0.0.0.0:9000
IMGPROXY_BIND_PORT=9200
IMGPROXY_PATH_PREFIX=/imgproxy

# Logging
IMGPROXY_LOG_LEVEL=warn
IMGPROXY_ENABLE_DEBUG_HEADERS=false
IMGPROXY_DEVELOPMENT_ERRORS_MODE=false
IMGPROXY_REPORT_DOWNLOADING_ERRORS=false

# Timeouts
IMGPROXY_READ_TIMEOUT=10
IMGPROXY_WRITE_TIMEOUT=10
IMGPROXY_DOWNLOAD_TIMEOUT=10
IMGPROXY_KEEP_ALIVE_TIMEOUT=300

# Image sources
IMGPROXY_TTL=2592000  # 30 days
IMGPROXY_USE_ETAG=false
IMGPROXY_SO_REUSEPORT=true
IMGPROXY_IGNORE_SSL_VERIFICATION=false
IMGPROXY_SKIP_PROCESSING_FORMATS=svg,webp,avif
IMGPROXY_MAX_SRC_RESOLUTION=50  # megapixels
IMGPROXY_MAX_SRC_FILE_SIZE=20971520  # 20MB

# Compression
IMGPROXY_STRIP_METADATA=true
IMGPROXY_STRIP_COLOR_PROFILE=true
IMGPROXY_FORMAT_QUALITY=jpeg=80,webp=70,avif=50
IMGPROXY_JPEG_PROGRESSIVE=false
IMGPROXY_PNG_INTERLACED=false
IMGPROXY_PNG_QUANTIZATION_COLORS=128
IMGPROXY_PNG_QUANTIZE=false
IMGPROXY_MAX_ANIMATION_FRAMES=64
IMGPROXY_AVIF_SPEED=8

# Signed URLs
IMGPROXY_KEY=insecure-key
IMGPROXY_SALT=insecure-salt
IMGPROXY_SIGNATURE_SIZE=32


### postgres-backup-local settings
### https://hub.docker.com/r/prodrigestivill/postgres-backup-local

POSTGRES_HOST=db
POSTGRES_DB=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_EXTRA_OPTS=--compression 7
SCHEDULE=@hourly
BACKUP_KEEP_MINS=20160
BACKUP_KEEP_DAYS=120
BACKUP_KEEP_WEEKS=52
BACKUP_KEEP_MONTHS=48
